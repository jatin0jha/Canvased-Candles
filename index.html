<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvased Candles</title>
    <style>
        * {
            scroll-behavior: smooth;
        }

        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background-color: #f8f8f8;
        }

        a {
            text-decoration: none;
        }

        .container-nav {
            background-color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .container-nav nav {
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .container-nav nav ul {
            display: flex;
            list-style: none;
            align-items: center;
            gap: 30px;
            padding: 0;
        }

        .container-nav nav ul li a {
            text-decoration: none;
            color: rgb(105, 105, 105);
        }


        .container-nav nav ul li a:hover {
            color: rgb(0, 0, 0);
        }

        .popup-search {
            display: none;
            /* Hide by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
        }

        .popup-search.active {
            display: flex;
            /* Show when active */
        }


        .search-card {
            margin: 5px;
            margin-top: 10vh;
            background-color: white;
            max-width: 600px;
            width: 100%;
            border-radius: 20px;
            height: 60px;
            /* Initial height */
            transition: height 0.3s ease-in-out;
            /* Smooth transition */
        }

        .search-input {
            width: calc(100% - 14px);
            height: 50px;
            border-radius: 20px;
            border: 5px solid rgb(194, 194, 194);
            outline: none;
        }

        .search-card:has(.search-input:focus) {
            height: 50vh;
            /* Expand smoothly */
        }

        section {
            display: none;
        }

        section.active {
            display: block;
        }

        .banner {
            aspect-ratio: 2.5;
            width: 100%;
            background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.244) 0, rgba(0, 0, 0, 0.856) 100%), url(https://c.pxhere.com/photos/a3/6c/chair_living_room_indoor_decor_flat-181502.jpg!d);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .banner p {
            color: white;
            font-size: 30px;
            font-weight: 200;
        }

        .product-title {
            text-align: center;
            padding: 10px;
            color: black;
            font-weight: 300;
            line-height: 1.5;
        }

        .product-title:hover {
            color: red;
            text-decoration: underline;
        }

        .product-card {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 10px;
            margin: 5px;
        }

        .product {
            text-align: center;
            background-color: white;
            padding: 3px;
            border-radius: 10px;
        }

        .product-image {
            width: 100%;
            aspect-ratio: 1;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 7px;
        }

        .product-image:hover {
            transition: 0.1s;
        }

        .product-price {
            text-align: center;
            margin-top: 5px;
        }

        .price-small {
            font-size: 12px;
            font-weight: bold;
            color: black;
            margin-right: 5px;
        }

        .original-price {
            font-size: 12px;
            text-decoration: line-through;
            color: gray;
        }

        .product-flex {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            max-width: 1000px;
            margin: 10px auto;
        }

        .product-flex h1 {
            font-size: 30px;
            font-weight: 200;

        }

        .nav-right-icons {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .carousel {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: 8px;
        }

        .carousel-images {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }

        .carousel-image {
            width: 100%;
            flex: 0 0 100%;
            object-fit: cover;
            border-radius: 10px;
        }

        .thumbnail-container {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }

        .thumbnail {
            width: 50px;
            height: 50px;
            object-fit: cover;
            margin: 5px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: border 0.3s ease;
            border-radius: 10px;
        }

        .thumbnail:hover,
        .thumbnail.active {
            border: 2px solid #000;
        }

        .hot-prod {
            display: grid;
            grid-template-columns: 2fr 3fr;
            margin: 5vh 20px;
            align-items: center;
            gap: 20px;
        }

        .hot-prod-img {
            aspect-ratio: 1;
            border-radius: 5px;
            background-color: rgb(216, 237, 255);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-image: url(https://s.alicdn.com/@sc04/kf/A6cc9e73e93554eb5a99698f3bf4cc690q.png);
        }


        footer {
            padding: 50px;
            background-color: rgb(255, 255, 255);
        }

        .foot-logo {
            height: 100px;
        }

        .foot-clmn ul {
            list-style: none;
        }

        .clmns {
            display: grid;
            grid-template-columns: 2fr 1fr 2fr;
            gap: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-family: Arial, sans-serif;
            font-size: 16px;
            color: #333;
        }

        table tr {
            border-bottom: 1px solid #ddd;
        }

        table td {
            padding: 12px 15px;
            text-align: left;
        }

        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        table tr:hover {
            background-color: #f1f1f1;
        }

        table td:first-child {
            font-weight: bold;
            width: 40%;
            color: #555;
        }

        table td:last-child {
            width: 60%;
        }

        .pricing {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-family: Arial, sans-serif;
        }

        .price-tier {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
            font-size: 16px;
            color: #333;
        }

        .price-tier:last-child {
            border-bottom: none;
        }

        .piece-prize {
            font-size: 18px;
            font-weight: bold;
            color: #27ae60;
        }

        .search-result {
            background: #f9f9f9;
            padding: 5px;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
        }

        #featured-products {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 10px;
            margin: 5px;
        }

        /* Base styles for both buttons */
        .btn-email,
        .btn-whatsapp {
            display: inline-block;
            padding: 12px 20px;
            margin: 10px 5px 10px 0;
            font-size: 16px;
            font-weight: bold;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Enquire on Email Button */
        .btn-email {
            background-color: #3498db;
            /* blue */
            color: #fff;
            border: 1px solid #3498db;
        }

        .btn-email:hover {
            background-color: #2980b9;
            border-color: #2980b9;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Enquire on WhatsApp Button */
        .btn-whatsapp {
            background-color: #25D366;
            /* WhatsApp green */
            color: #fff;
            border: 1px solid #25D366;
        }

        .btn-whatsapp:hover {
            background-color: #1ebe57;
            border-color: #1ebe57;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #F6F6F6; display: flex; justify-content: center; align-items: center; z-index: 9999;">
        <img src="https://i.pinimg.com/originals/9f/ad/79/9fad79ec23e09691320df47a88ed73d8.gif" alt="Loading..." style="width: 100px;">
    </div>

    <div class="container-nav">
        <nav>
            <ul>
                <img src="assets/logo.png" alt="" height="50px" class="logo">
                <li><a href="#home">Home</a></li>
                <li><a href="#products">Products</a></li>
                <li><a href="#custom">Custom order</a></li>
            </ul>
            <div class="nav-right-icons">
                <a href="#search"><img src="assets/search.svg" height="30px" alt="" class="search"></a>
            </div>
        </nav>
    </div>

    <section id="home">
        <nav>
            <ul style="padding: 0; margin: 0;">
                <li>
                    <a href="#products">
                        <div style="display: flex; align-items: center; justify-content: center" class="banner">
                            <p>VIEW ALL PRODUCTS</p>
                        </div>
                    </a>
                </li>
            </ul>
        </nav>
        <div class="hot-prod">
            <div class="hot-prod-img"></div>
            <div class="hot-prod-txt">
                <p style="font-size: 23px; font-weight: 300">MARBLE SHELF</p>
                <p style="font-size: 14px; color: rgb(113, 113, 113); line-height: 1.7">
                    Elevate the ambiance of your living spaces with the exquisite allure of marble. Introducing the
                    Bedroom Living Room Table Marble Shelf Bedside Coffee Tea Table for Home Decor. This opulent piece
                    is not just furniture; it's a statement, a symbol of refined taste. Crafted with precision and
                    adorned with the timeless elegance of marble, this table seamlessly merges functionality with
                    aesthetic appeal. Whether gracing your bedroom, living room, or serving as a sophisticated bedside
                    or coffee table, its presence transforms ordinary spaces into extraordinary realms of style. The
                    smooth marble surface exudes luxury, providing an ideal platform for decor elements or a cozy cup of
                    tea. Embrace the fusion of practicality and sophistication, as this marble table becomes the focal
                    point for creating memorable moments in your home.
                </p>
                <nav>
                    <ul style="list-style: none; padding: 0;">
                        <li>
                            <a style="
                          text-decoration: underline;
                          text-underline-offset: 5px;
                          color: black;
                        " href="#products">SHOP NOW</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <h1>
            <p style="font-size: 27px; font-weight: 200; width: 100%; text-align: center;">FEATURED PRODUCTS</p>
        </h1>

        <div id="featured-products"></div>
    </section>

    <section id="products">
        <p style="
          text-align: center;
          font-size: 27px;
          font-weight: 200;
          padding: 30px;
        ">
            PRODUCTS
        </p>
        <div style="
          display: flex;
          justify-content: space-between;
          border: 0.5px solid rgb(196, 196, 196);
          padding: 8px 60px;
          margin-bottom: 60px;
        ">
            <div></div>
            <div>
                <a style="padding: 10px 30px;border: 0.5px solid rgb(196, 196, 196); margin: 0;" href="">FILTER</a>
            </div>
        </div>
        <div class="product-card">
        </div>
    </section>

    <section id="custom">
        <div data-aidaform-app="form202405" data-url="https://blubranch.aidaform.com/canvased-candles" data-width="100%"
            data-height="500px" data-do-resize></div>
        <script>(function () { var r, d = document, gt = d.getElementById, cr = d.createElement, tg = d.getElementsByTagName, id = "aidaform-app"; if (!gt.call(d, id)) { r = cr.call(d, "script"); r.id = id; r.src = "https://widget.aidaform.com/embed.js"; (d.head || tg.call(d, "head")[0]).appendChild(r); } })()</script>
    </section>

    <div class="popup-search" id="search">
        <div class="search-card">
            <input type="text" placeholder="Search for products" class="search-input">
            <div id="search-results"></div>
        </div>
    </div>

    <footer>
        <div class="clmns">
            <div class="foot-clmn">

                <img class="foot-logo" src="assets/logo.png" alt="" />

                <p>
                    We focus on finest and pre-eminent designs handcasted in concrete
                    with a sustainable approach. We intend to serve you with the
                    products that are authentic yet feel luxurious
                </p>
            </div>

            <div class="foot-clmn">
            </div>

            <div class="foot-clmn">
                <h4>Contact Us</h4>
                <a href="mailto:fragrantiacandle234@gmail.com">fragrantiacandle234@gmail.com</a><br><br>
                <a href="https://wa.me/917210111699">Whatsapp Us At +91 7210111699</a><br><br>
                <a href="https://www.instagram.com/canvasedcandles" style="display: flex; align-items: center;"><img src="https://www.svgrepo.com/show/521711/instagram.svg" height="30px" alt="">Instagram</a><br>
                <a href="https://www.facebook.com/profile.php?id=61568587108087" style="display: flex; align-items: center;"><img src="https://www.svgrepo.com/show/475647/facebook-color.svg" height="30px" alt="">Facebook</a>
            </div>
        </div>


        <div style="display: flex; justify-content: space-between; padding-top: 10vh">
            <p>© Eve Crafts Overseas. ALL RIGHTS RESERVED</p>
            <p>POWERED BY ©<a href="https://jatinjha.pages.dev/">BlueBranch</a> Inc. Iowa City, USA</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            const links = document.querySelectorAll('nav ul li a'); // Navigation links
            const staticSections = document.querySelectorAll('section'); // Original sections
            const searchPopup = document.querySelector('.popup-search'); // Search popup
            const searchCard = document.querySelector('.search-card');
            const searchInput = document.querySelector('.search-input');
            const searchIcon = document.querySelector('.search');
            const closeButton = document.querySelector('.back');
            const productCardContainer = document.querySelector('.product-card');
            const loadingScreen = document.getElementById('loading-screen');

            // Fetch products data from Google Apps Script
            let products = [];
            try {
                const response = await fetch('https://script.googleusercontent.com/macros/echo?user_content_key=7H6NSRF0rPH4jBam61lo6_5cJNZklfTNnKMp2VCo7KTOSAl0Rbvsz9VdZPVvwVa3AE1N2w0Ku4qmSQjMk377ikWyYneHfzqQm5_BxDlH2jW0nuo2oDemN9CCS2h10ox_1xSncGQajx_ryfhECjZEnJt6TV5XV7frGHDM9Mi-ZksGZqqJz98EiXkBH_UoQgRLPrIsfuF84-iLriPAMlbjcWapO16vv04gjBybSJRRrYGRRP5Yk-Abg9z9Jw9Md8uu&lib=MAhZX5Bdo8ouuQOtyGgCDT6xPqkNoE23-');
                products = await response.json();
            } catch (error) {
                console.error('Error fetching products:', error);
                products = []; // Empty array as fallback
            } finally {
                // Hide loading screen once data is loaded
                loadingScreen.style.display = 'none';
            }

            // Generate featured products listing dynamically (top 4 products)
            const featuredProductsContainer = document.getElementById('featured-products');
            if (featuredProductsContainer) {
                products.slice(0, 4).forEach(product => {
                    const productDiv = document.createElement('div');
                    productDiv.className = 'product';

                    const productLink = document.createElement('a');
                    productLink.href = `#${product.id}`;

                    const productImage = document.createElement('div');
                    productImage.className = 'product-image';
                    productImage.style.backgroundImage = `url(${product.imageSrc})`;

                    // Swap to hover image on mouse enter and revert on mouse leave
                    productImage.addEventListener('mouseenter', () => {
                        productImage.style.backgroundImage = `url(${product.hoverImageSrc})`;
                    });
                    productImage.addEventListener('mouseleave', () => {
                        productImage.style.backgroundImage = `url(${product.imageSrc})`;
                    });

                    const productTitle = document.createElement('p');
                    productTitle.className = 'product-title';
                    productTitle.textContent = product.title;

                    const productPriceContainer = document.createElement('div');
                    productPriceContainer.className = 'product-price';

                    const productPrice = document.createElement('span');
                    productPrice.className = 'price-small';
                    productPrice.textContent = product.price;

                    const productOriginalPrice = document.createElement('span');
                    productOriginalPrice.className = 'original-price';
                    productOriginalPrice.textContent = product.originalPrice;

                    productPriceContainer.appendChild(productPrice);
                    productPriceContainer.appendChild(productOriginalPrice);

                    productLink.appendChild(productImage);
                    productLink.appendChild(productTitle);
                    productDiv.appendChild(productLink);
                    productDiv.appendChild(productPriceContainer);

                    featuredProductsContainer.appendChild(productDiv);

                    // On click, generate the product section
                    productLink.addEventListener('click', function (event) {
                        event.preventDefault();
                        window.location.hash = product.id;
                        generateProductPage(product);
                    });
                });
            }

            // --- ADD SEARCH FUNCTIONALITY WITH DEBUGGING ---

            // Listen for input changes in the search field
            searchInput.addEventListener('input', function () {
                const query = searchInput.value.trim().toLowerCase();
                console.log("Search query:", query); // Debug: Log current query

                const resultsContainer = document.getElementById('search-results');
                resultsContainer.innerHTML = ''; // Clear previous results

                // Only process if there's some query text
                if (query.length > 0) {
                    // Filter products based on their title (case-insensitive)
                    const results = products.filter(product =>
                        product.title.toLowerCase().includes(query)
                    );
                    console.log("Found results:", results); // Debug: Log filtered results

                    if (results.length === 0) {
                        resultsContainer.innerHTML = `<p>No results found.</p>`;
                    } else {
                        results.forEach(product => {
                            // Create a result item for each matching product
                            const resultItem = document.createElement('div');
                            resultItem.className = 'search-result';
                            resultItem.innerHTML = `<p>${product.title}</p>`;

                            // When a result is clicked, close the search popup and generate the product page
                            resultItem.addEventListener('click', function () {
                                searchPopup.classList.remove('active');
                                window.location.hash = product.id;
                                generateProductPage(product);
                            });

                            resultsContainer.appendChild(resultItem);
                        });
                    }
                }
            });

            // Function to show a section and hide all others (including dynamically generated product sections)
            function showSection(sectionId) {
                document.querySelectorAll('section, .dynamic-product-section').forEach(section => {
                    section.classList.remove('active');
                });

                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    window.scrollTo(0, 0); // Scroll to the top
                }
            }

            // Navigation click event to show the selected section
            links.forEach(link => {
                link.addEventListener('click', function (event) {
                    event.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    if (targetId === "search") return;
                    showSection(targetId);
                    window.location.hash = targetId;
                });
            });

            // Function to generate a product detail page dynamically
            function generateProductPage(product) {
                // Remove any existing dynamic product sections
                document.querySelectorAll('.dynamic-product-section').forEach(section => section.remove());

                // Create the product section
                const productSection = document.createElement('section');
                productSection.id = product.id;
                productSection.classList.add('active', 'dynamic-product-section');

                // Compute the enquiry messages
                const emailSubject = encodeURIComponent("Enquiry about " + product.title);
                const emailBody = encodeURIComponent("I would like to enquire about " + product.title + ". Please provide more details.");
                const whatsappText = encodeURIComponent("I would like to enquire about " + product.title + ". Please provide more details.");

                productSection.innerHTML = `
                    <div class="product-flex">
                        <div class="carousel">
                            <div class="carousel-images">
                                ${product.images.map(img => `<img src="${img}" class="carousel-image">`).join('')}
                            </div>
                            <div class="thumbnail-container">
                                ${product.images.map((img, index) => `<img src="${img}" class="thumbnail" data-index="${index}">`).join('')}
                            </div>
                        </div>

                        <div>
                            <h1>${product.title}</h1>
                            <p>${product.description}</p>
                            
                            <div class="pricing">
                                ${product.pricingTiers.map(tier => `
                                    <div class="price-tier">
                                        <div>${tier.range}</div>
                                        <div class="piece-prize"><b>${tier.price}</b></div>
                                    </div>
                                `).join('')}
                            </div>

                            <h2>Specifications</h2>
                            <table>
                                ${Object.entries(product.specifications).map(([key, value]) => `
                                    <tr>
                                        <td>${key}</td>
                                        <td>${value}</td>
                                    </tr>
                                `).join('')}
                            </table>

                            <!-- Enquiry Buttons with Dynamic Links -->
                            <a href="mailto:fragrantiacandle234@gmail.com?subject=${emailSubject}&body=${emailBody}" target="_blank" class="btn-email">
                                Enquire on Email
                            </a>
                            <a href="https://wa.me/917210111699?text=${whatsappText}" target="_blank" class="btn-whatsapp">
                                Enquire on WhatsApp
                            </a>
                        </div>
                    </div>
                `;

                // Insert the product section before the footer
                const footer = document.querySelector('footer');
                document.body.insertBefore(productSection, footer);

                // Scroll to top (if needed)
                window.scrollTo(0, 0);

                // Show the product section
                showSection(product.id);

                // ** Carousel Logic **
                const carouselImages = productSection.querySelector('.carousel-images');
                const thumbnails = productSection.querySelectorAll('.thumbnail');

                thumbnails.forEach(thumbnail => {
                    thumbnail.addEventListener('click', function () {
                        const index = this.getAttribute('data-index');
                        carouselImages.style.transform = `translateX(-${index * 100}%)`;
                        thumbnails.forEach(thumb => thumb.classList.remove('active'));
                        this.classList.add('active');
                    });
                });

                // Set first thumbnail as active
                if (thumbnails.length > 0) thumbnails[0].classList.add('active');
            }

            // Generate product listing dynamically
            if (productCardContainer) {
                products.forEach(product => {
                    const productDiv = document.createElement('div');
                    productDiv.className = 'product';

                    const productLink = document.createElement('a');
                    productLink.href = `#${product.id}`;

                    const productImage = document.createElement('div');
                    productImage.className = 'product-image';
                    productImage.style.backgroundImage = `url(${product.imageSrc})`;

                    productImage.addEventListener('mouseenter', () => {
                        productImage.style.backgroundImage = `url(${product.hoverImageSrc})`;
                    });

                    productImage.addEventListener('mouseleave', () => {
                        productImage.style.backgroundImage = `url(${product.imageSrc})`;
                    });

                    const productTitle = document.createElement('p');
                    productTitle.className = 'product-title';
                    productTitle.textContent = product.title;

                    const productPriceContainer = document.createElement('div');
                    productPriceContainer.className = 'product-price';

                    const productPrice = document.createElement('span');
                    productPrice.className = 'price-small';
                    productPrice.textContent = product.price;

                    const productOriginalPrice = document.createElement('span');
                    productOriginalPrice.className = 'original-price';
                    productOriginalPrice.textContent = product.originalPrice;

                    productPriceContainer.appendChild(productPrice);
                    productPriceContainer.appendChild(productOriginalPrice);

                    productLink.appendChild(productImage);
                    productLink.appendChild(productTitle);
                    productDiv.appendChild(productLink);
                    productDiv.appendChild(productPriceContainer);

                    productCardContainer.appendChild(productDiv);

                    // On click, generate the product section
                    productLink.addEventListener('click', function (event) {
                        event.preventDefault();
                        window.location.hash = product.id;
                        generateProductPage(product);
                    });
                });
            }

            // Handle page refresh with hash navigation
            const urlHash = window.location.hash.replace('#', '');
            if (urlHash) {
                const product = products.find(p => p.id === urlHash);
                if (product) generateProductPage(product);
                else showSection(urlHash);
            }

            // Search functionality
            function openSearch(event) {
                event.preventDefault();
                searchPopup.classList.add('active');
                searchInput.focus();
            }

            function closeSearch(event) {
                if (!searchCard.contains(event.target) && event.target !== searchIcon) {
                    searchPopup.classList.remove('active');
                }
            }

            searchIcon.addEventListener('click', openSearch);
            document.addEventListener('click', closeSearch);
            closeButton?.addEventListener('click', function (event) {
                event.preventDefault();
                searchPopup.classList.remove('active');
            });

            // Show the home section by default if no hash exists
            if (!window.location.hash) showSection('home');
        });

    </script>
</body>

</html>